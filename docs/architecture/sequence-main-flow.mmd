sequenceDiagram
    participant Client
    participant Filter as JwtAuthFilter
    participant ABAC as AbacEvaluator
    participant Controller
    participant Service
    participant DB as PostgreSQL
    participant Outbox
    Client->>Filter: POST /v1/tenants (JWT + X-Tenant-Id)
    Filter->>Filter: Validate JWT, extract claims (tid, roles, perms, plan, region)
    Filter->>Filter: Enforce X-Tenant-Id == tid
    Filter->>ABAC: evaluate(permission, plan, region)
    ABAC->>DB: load enabled policies
    ABAC->>ABAC: DENY precedence, default-deny
    alt Access Denied
        ABAC->>DB: audit_log (ACCESS_DENIED)
        ABAC-->>Client: 403 Forbidden
    else Access Allowed
        ABAC->>Controller: proceed
        Controller->>Service: createTenant(request)
        Service->>DB: INSERT tenant
        Service->>Outbox: INSERT outbox_event (PENDING)
        Service->>DB: INSERT audit_log (TENANT_CREATED)
        Service-->>Controller: Tenant
        Controller-->>Client: 201 Created
    end
